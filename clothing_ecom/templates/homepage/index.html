{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StyleHub - Homepage</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#000000",
              secondary: "#ffffff",
              accent: "#f3f4f6",
            },
          },
        },
      };
    </script>
  </head>
  <body class="min-h-screen bg-gray-50">
    <!-- Top Banner -->
    <header class="bg-black text-white text-center py-2 px-4">
      <p class="text-sm font-medium">
        HUGE WINTER SALE. UPTO 50% OFF!
        <a href="#" class="underline hover:text-gray-300 transition-colors ml-2"
          >SHOP NOW!</a
        >
      </p>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <!-- Logo -->
          <div class="flex-shrink-0">
            <h1 class="text-2xl font-bold text-gray-900">StyleHub</h1>
          </div>

          <!-- Desktop Navigation -->
          <div class="hidden md:block">
            <div class="ml-10 flex items-baseline space-x-8">
              <a
                href="{% url 'home' %}"
                class="text-gray-900 hover:text-gray-600 px-3 py-2 text-sm font-medium transition-colors"
              >
                Home
              </a>
              <a href="{% if user.is_authenticated %}
            {% if user.is_superuser %}
                {% url 'admin_dashboard' %}
            {% else %}
                #
            {% endif %}
          {% else %}
            #
          {% endif %}"
   class="text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors flex items-center">
    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
    </svg>
    {% if user.is_authenticated %}
        {% if user.is_superuser %}
            {{ user.username }}
        {% else %}
            {{ user.username }}
        {% endif %}
    {% else %}
        Account
    {% endif %}
</a>

              <a
                href="{% url 'view_cart' %}"
                class="text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors flex items-center"
              >
                Cart (<span id="cart-count">{{ cart_count }}</span>)
              </a>
              {% if user.is_authenticated %}
              <a
                href="{% url 'logout' %}"
                class="text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors"
              >
                Logout
              </a>
              {% else %}
              <a
                href="{% url 'login' %}"
                class="text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors"
              >
                Login
              </a>
              {% endif %}
            </div>
          </div>

          <!-- Mobile menu button -->
          <div class="md:hidden">
            <button
              id="mobile-menu-btn"
              class="text-gray-700 hover:text-gray-900 p-2"
            >
              <svg
                id="menu-icon"
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"
                ></path>
              </svg>
              <svg
                id="close-icon"
                class="w-6 h-6 hidden"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                ></path>
              </svg>
            </button>
          </div>
        </div>

        <!-- Mobile Navigation -->
        <div id="mobile-menu" class="md:hidden border-t border-gray-200 hidden">
          <div class="px-2 pt-2 pb-3 space-y-1 bg-white">
            <a
              href="{% url 'home' %}"
              class="text-gray-900 hover:text-gray-600 block px-3 py-2 text-base font-medium"
              >Home</a
            >
            <a
              href="#"
              class="text-gray-700 hover:text-gray-900 block px-3 py-2 text-base font-medium"
            >
              {% if user.is_authenticated %}{{ user.username }}{% else
              %}Account{% endif %}
            </a>
            <a
              href="{% url 'view_cart' %}"
              class="text-gray-700 hover:text-gray-900 block px-3 py-2 text-base font-medium"
            >
              Cart ({{ cart_count }})
            </a>
            {% if user.is_authenticated %}
            <a
              href="{% url 'logout' %}"
              class="text-gray-700 hover:text-gray-900 block px-3 py-2 text-base font-medium"
              >Logout</a
            >
            {% else %}
            <a
              href="{% url 'login' %}"
              class="text-gray-700 hover:text-gray-900 block px-3 py-2 text-base font-medium"
              >Login</a
            >
            {% endif %}
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <!-- Just Landed Section -->
      <section class="mb-12">
        <div class="text-center mb-8">
          <h2 class="text-3xl font-bold text-gray-900 mb-2">Just Landed</h2>
          <p class="text-gray-600 max-w-2xl mx-auto">
            Discover our latest arrivals featuring the newest trends and styles
            for the season.
          </p>
        </div>

        <!-- Category Filter Buttons -->
        <div class="flex flex-wrap justify-center gap-3 mb-8">
          <button
            onclick="filterProducts('all')"
            class="filter-btn active bg-black text-white px-6 py-2 rounded-full text-sm font-medium transition-all duration-300"
          >
            All Products ({{ category_counts.All }})
          </button>
          <button
            onclick="filterProducts('Men')"
            class="filter-btn bg-white text-gray-700 border border-gray-300 px-6 py-2 rounded-full text-sm font-medium transition-all duration-300"
          >
            Men ({{ category_counts.Men }})
          </button>
          <button
            onclick="filterProducts('Women')"
            class="filter-btn bg-white text-gray-700 border border-gray-300 px-6 py-2 rounded-full text-sm font-medium transition-all duration-300"
          >
            Women ({{ category_counts.Women }})
          </button>
          <button
            onclick="filterProducts('Accessories')"
            class="filter-btn bg-white text-gray-700 border border-gray-300 px-6 py-2 rounded-full text-sm font-medium transition-all duration-300"
          >
            Accessories ({{ category_counts.Accessories }})
          </button>
        </div>

        <!-- Products Grid -->
        <div
          id="products-grid"
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
        >
          <!-- Men Products -->
          {% for product in men_products %}
          <div
            class="product-card bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-all duration-300 group"
            data-category="Men"
          >
            <div class="relative overflow-hidden">
              <a href="{% url 'product_detail' product.id %}">
                <img
                  src="{{ product.image.url }}"
                  alt="{{ product.name }}"
                  class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300"
                />
              </a>
              <div
                class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"
              ></div>
              
              {% if product.quantity_available == 0 %}
              <div
                class="absolute top-2 left-2 bg-gray-500 text-white text-xs px-2 py-1 rounded"
              >
                Out of Stock
              </div>
              {% elif product.quantity_available <= 5 %}
              <div
                class="absolute top-2 left-2 bg-red-500 text-white text-xs px-2 py-1 rounded"
              >
                Only {{ product.quantity_available }} left!
              </div>
              {% endif %}
            </div>

            <div class="p-4">
              <div class="mb-2">
                <span
                  class="text-xs font-medium text-gray-500 uppercase tracking-wide"
                >
                  {{ product.category }}
                </span>
              </div>
              <h3 class="text-lg font-semibold text-gray-900 mb-2 line-clamp-2">
                <a href="{% url 'product_detail' product.id %}" class="hover:text-gray-600 transition-colors">
                  {{ product.name }}
                </a>
              </h3>
              <p class="text-xl font-bold text-gray-900 mb-4">
                ${{ product.price }}
              </p>

              <div class="flex flex-col sm:flex-row gap-2">
                {% if product.quantity_available > 0 %}
                  <a
                    href="{% url 'buy' product.id %}"
                    class="flex-1 bg-black hover:bg-gray-800 text-white text-center py-2 px-4 rounded-md text-sm font-medium transition-colors duration-300"
                  >
                    Buy Now
                  </a>
                  <a
                    href="{% url 'add_to_cart' product.id %}?next=home"
                    class="flex-1 border border-gray-300 hover:bg-gray-50 text-gray-700 text-center py-2 px-4 rounded-md text-sm font-medium transition-colors duration-300"
                  >
                    Add to Cart
                  </a>
                {% else %}
                  <button
                    disabled
                    class="flex-1 bg-gray-400 text-white py-2 px-4 rounded-md text-sm font-medium cursor-not-allowed"
                  >
                    Out of Stock
                  </button>
                  <a
                    href="{% url 'product_detail' product.id %}"
                    class="flex-1 border border-gray-300 hover:bg-gray-50 text-gray-700 text-center py-2 px-4 rounded-md text-sm font-medium transition-colors duration-300"
                  >
                    View Details
                  </a>
                {% endif %}
              </div>
            </div>
          </div>
          {% endfor %}

          <!-- Women Products -->
          {% for product in women_products %}
          <div
            class="product-card bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-all duration-300 group"
            data-category="Women"
          >
            <div class="relative overflow-hidden">
              <a href="{% url 'product_detail' product.id %}">
                <img
                  src="{{ product.image.url }}"
                  alt="{{ product.name }}"
                  class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300"
                />
              </a>
              <div
                class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"
              ></div>
              
              {% if product.quantity_available == 0 %}
              <div
                class="absolute top-2 left-2 bg-gray-500 text-white text-xs px-2 py-1 rounded"
              >
                Out of Stock
              </div>
              {% elif product.quantity_available <= 5 %}
              <div
                class="absolute top-2 left-2 bg-red-500 text-white text-xs px-2 py-1 rounded"
              >
                Only {{ product.quantity_available }} left!
              </div>
              {% endif %}
            </div>

            <div class="p-4">
              <div class="mb-2">
                <span
                  class="text-xs font-medium text-gray-500 uppercase tracking-wide"
                >
                  {{ product.category }}
                </span>
              </div>
              <h3 class="text-lg font-semibold text-gray-900 mb-2 line-clamp-2">
                <a href="{% url 'product_detail' product.id %}" class="hover:text-gray-600 transition-colors">
                  {{ product.name }}
                </a>
              </h3>
              <p class="text-xl font-bold text-gray-900 mb-4">
                ${{ product.price }}
              </p>

              <div class="flex flex-col sm:flex-row gap-2">
                {% if product.quantity_available > 0 %}
                  <a
                    href="{% url 'buy' product.id %}"
                    class="flex-1 bg-black hover:bg-gray-800 text-white text-center py-2 px-4 rounded-md text-sm font-medium transition-colors duration-300"
                  >
                    Buy Now
                  </a>
                  <a
                    href="{% url 'add_to_cart' product.id %}?next=home"
                    class="flex-1 border border-gray-300 hover:bg-gray-50 text-gray-700 text-center py-2 px-4 rounded-md text-sm font-medium transition-colors duration-300"
                  >
                    Add to Cart
                  </a>
                {% else %}
                  <button
                    disabled
                    class="flex-1 bg-gray-400 text-white py-2 px-4 rounded-md text-sm font-medium cursor-not-allowed"
                  >
                    Out of Stock
                  </button>
                  <a
                    href="{% url 'product_detail' product.id %}"
                    class="flex-1 border border-gray-300 hover:bg-gray-50 text-gray-700 text-center py-2 px-4 rounded-md text-sm font-medium transition-colors duration-300"
                  >
                    View Details
                  </a>
                {% endif %}
              </div>
            </div>
          </div>
          {% endfor %}

          <!-- Accessories Products -->
          {% for product in accessories_products %}
          <div
            class="product-card bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-all duration-300 group"
            data-category="Accessories"
          >
            <div class="relative overflow-hidden">
              <a href="{% url 'product_detail' product.id %}">
                <img
                  src="{{ product.image.url }}"
                  alt="{{ product.name }}"
                  class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300"
                />
              </a>
              <div
                class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"
              ></div>
              
              {% if product.quantity_available == 0 %}
              <div
                class="absolute top-2 left-2 bg-gray-500 text-white text-xs px-2 py-1 rounded"
              >
                Out of Stock
              </div>
              {% elif product.quantity_available <= 5 %}
              <div
                class="absolute top-2 left-2 bg-red-500 text-white text-xs px-2 py-1 rounded"
              >
                Only {{ product.quantity_available }} left!
              </div>
              {% endif %}
            </div>

            <div class="p-4">
              <div class="mb-2">
                <span
                  class="text-xs font-medium text-gray-500 uppercase tracking-wide"
                >
                  {{ product.category }}
                </span>
              </div>
              <h3 class="text-lg font-semibold text-gray-900 mb-2 line-clamp-2">
                <a href="{% url 'product_detail' product.id %}" class="hover:text-gray-600 transition-colors">
                  {{ product.name }}
                </a>
              </h3>
              <p class="text-xl font-bold text-gray-900 mb-4">
                ${{ product.price }}
              </p>

              <div class="flex flex-col sm:flex-row gap-2">
                {% if product.quantity_available > 0 %}
                  <a
                    href="{% url 'buy' product.id %}"
                    class="flex-1 bg-black hover:bg-gray-800 text-white text-center py-2 px-4 rounded-md text-sm font-medium transition-colors duration-300"
                  >
                    Buy Now
                  </a>
                  <a
                    href="{% url 'add_to_cart' product.id %}?next=home"
                    class="flex-1 border border-gray-300 hover:bg-gray-50 text-gray-700 text-center py-2 px-4 rounded-md text-sm font-medium transition-colors duration-300"
                  >
                    Add to Cart
                  </a>
                {% else %}
                  <button
                    disabled
                    class="flex-1 bg-gray-400 text-white py-2 px-4 rounded-md text-sm font-medium cursor-not-allowed"
                  >
                    Out of Stock
                  </button>
                  <a
                    href="{% url 'product_detail' product.id %}"
                    class="flex-1 border border-gray-300 hover:bg-gray-50 text-gray-700 text-center py-2 px-4 rounded-md text-sm font-medium transition-colors duration-300"
                  >
                    View Details
                  </a>
                {% endif %}
              </div>
            </div>
          </div>
          {% endfor %}
        </div>

        <!-- No products message (hidden by default) -->
        <div id="no-products-message" class="text-center py-12 hidden">
          <div class="text-gray-400 mb-4">
            <svg
              class="w-16 h-16 mx-auto"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1"
                d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m13-8l-4 4m0 0l-4-4m4 4V3"
              ></path>
            </svg>
          </div>
          <p class="text-gray-500 text-lg">
            No products found in this category.
          </p>
        </div>
      </section>

      <!-- Newsletter Section -->
<section class="bg-gray-900 rounded-2xl p-8 text-center text-white">
  <h3 class="text-2xl font-bold mb-2">Stay in the Loop</h3>
  <p class="text-gray-300 mb-6 max-w-md mx-auto">
    Subscribe to our newsletter and be the first to know about new arrivals and exclusive offers.
  </p>
  <form id="newsletter-form" method="POST" action="{% url 'subscribe_newsletter' %}" class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
    {% csrf_token %}
    <input
      type="email"
      name="email"
      id="newsletter-email"
      placeholder="Enter your email"
      required
      class="flex-1 px-4 py-2 rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-white"
    />
    <button 
      type="submit" 
      id="newsletter-btn"
      class="bg-white text-gray-900 hover:bg-gray-100 px-6 py-2 rounded-lg font-medium transition-colors duration-300"
    >
      Subscribe
    </button>
  </form>
  
  <!-- Success/Error Messages -->
  <div id="newsletter-message" class="mt-4 hidden">
    <div id="newsletter-success" class="text-green-300 text-sm hidden">
      <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
      </svg>
      <span id="success-text"></span>
    </div>
    <div id="newsletter-error" class="text-red-300 text-sm hidden">
      <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
      <span id="error-text"></span>
    </div>
  </div>
</section>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="text-center text-gray-600">
          <p>&copy; 2025 StyleHub. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <script>
      // Mobile menu toggle
      const mobileMenuBtn = document.getElementById("mobile-menu-btn");
      const mobileMenu = document.getElementById("mobile-menu");
      const menuIcon = document.getElementById("menu-icon");
      const closeIcon = document.getElementById("close-icon");

      mobileMenuBtn.addEventListener("click", function () {
        mobileMenu.classList.toggle("hidden");
        menuIcon.classList.toggle("hidden");
        closeIcon.classList.toggle("hidden");
      });

      // Product filtering functionality
      function filterProducts(category) {
        const productCards = document.querySelectorAll(".product-card");
        const filterButtons = document.querySelectorAll(".filter-btn");
        const noProductsMessage = document.getElementById(
          "no-products-message"
        );
        let visibleCount = 0;

        // Update active button
        filterButtons.forEach((btn) => {
          btn.classList.remove("active", "bg-black", "text-white");
          btn.classList.add(
            "bg-white",
            "text-gray-700",
            "border",
            "border-gray-300"
          );
        });

        // Set active button
        event.target.classList.add("active", "bg-black", "text-white");
        event.target.classList.remove(
          "bg-white",
          "text-gray-700",
          "border",
          "border-gray-300"
        );

        // Filter products with animation
        productCards.forEach((card, index) => {
          const productCategory = card.getAttribute("data-category");

          if (category === "all" || productCategory === category) {
            card.style.display = "block";
            // Staggered fade-in animation
            card.style.opacity = "0";
            card.style.transform = "translateY(20px)";
            setTimeout(() => {
              card.style.opacity = "1";
              card.style.transform = "translateY(0)";
            }, index * 50);
            visibleCount++;
          } else {
            card.style.opacity = "0";
            card.style.transform = "translateY(-20px)";
            setTimeout(() => {
              card.style.display = "none";
            }, 200);
          }
        });

        // Show/hide no products message
        setTimeout(() => {
          if (visibleCount === 0) {
            noProductsMessage.classList.remove("hidden");
          } else {
            noProductsMessage.classList.add("hidden");
          }
        }, 300);
      }

      // Add smooth transitions to product cards
      document.addEventListener("DOMContentLoaded", function () {
        const productCards = document.querySelectorAll(".product-card");
        productCards.forEach((card) => {
          card.style.transition = "all 0.3s ease-in-out";
        });
      });
      // Newsletter subscription with AJAX
    document.getElementById('newsletter-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const form = this;
        const emailInput = document.getElementById('newsletter-email');
        const submitBtn = document.getElementById('newsletter-btn');
        const messageDiv = document.getElementById('newsletter-message');
        const successDiv = document.getElementById('newsletter-success');
        const errorDiv = document.getElementById('newsletter-error');
        const successText = document.getElementById('success-text');
        const errorText = document.getElementById('error-text');
        
        const email = emailInput.value.trim();
        
        // Basic validation
        if (!email) {
            showError('Please enter an email address.');
            return;
        }
        
        if (!isValidEmail(email)) {
            showError('Please enter a valid email address.');
            return;
        }
        
        // Show loading state
        submitBtn.disabled = true;
        submitBtn.textContent = 'Subscribing...';
        hideMessages();
        
        // Send AJAX request
        fetch(form.action, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': form.querySelector('[name=csrfmiddlewaretoken]').value
            },
            body: new URLSearchParams(new FormData(form))
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                showSuccess(data.message);
                emailInput.value = '';
            } else {
                showError(data.message);
            }
        })
        .catch(error => {
            console.error('Newsletter subscription error:', error);
            showError('Sorry, there was an error processing your subscription. Please try again later.');
        })
        .finally(() => {
            // Reset button state
            submitBtn.disabled = false;
            submitBtn.textContent = 'Subscribe';
        });
        
        function showSuccess(message) {
            successText.textContent = message;
            successDiv.classList.remove('hidden');
            errorDiv.classList.add('hidden');
            messageDiv.classList.remove('hidden');
        }
        
        function showError(message) {
            errorText.textContent = message;
            errorDiv.classList.remove('hidden');
            successDiv.classList.add('hidden');
            messageDiv.classList.remove('hidden');
        }
        
        function hideMessages() {
            messageDiv.classList.add('hidden');
            successDiv.classList.add('hidden');
            errorDiv.classList.add('hidden');
        }
        
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
    });
    </script>
  </body>
</html>
